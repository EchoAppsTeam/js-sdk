<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>v2 - v3 compatibility check</title>
	<link rel="stylesheet" type="text/css" href="demo.css" />
	<!-- Default v3 scripts inclusion -->
	<script type="text/javascript" src="{%=baseURLs.sdk%}/loader.js"></script>
	<!-- Default v2 scripts inclusion -->
	<script src="http://cdn.echoenabled.com/clientapps/v2/packs/full-pack.js"></script>

	<script>
	Echo.require(["echo/backplane"], function() {});
	Backplane.init({
		"serverBaseURL": "https:{%=baseURLs.api.backplane%}/v1",
		"busName": "jskit"
	});
	var identityManager = {"width": 400, "height": 240, "url": "https://echo.rpxnow.com/openid/embed?flags=stay_in_window,no_immediate&token_url=http%3A%2F%2Fechoenabled.com%2Fapps%2Fjanrain%2Fwaiting.html&bp_channel="};
	</script>
</head>
<body>
<div class="container">
	<div id="container-v2">
		<h2>Echo Apps v2</h2>
		<div class="wrapper">
			<!-- Echo.Stream v2 -->
			<b>Stream</b>
			<div id="stream-v2"></div>

			<script type="text/javascript">
				new Echo.Stream({
					"target": document.getElementById("stream-v2"),
					"appkey": "echo.jssdk.demo.aboutecho.com",
					"query": "childrenof:http://example.com/* itemsPerPage:1",
					"viaLabel": { "icon": true, "text": true },
					"plugins": [{
						"name": "TwitterIntents"
					}, {
						"name": "CommunityFlag",
						"showUserList": true
					}, {
						"name": "Like"
					}, {
						"name": "Reply",
						"useDisplayName": true,
						"actionString": "Write reply here...",
						"nestedPlugins": [
							{
								"name": "SubmitTextCounter"
							}, {
								"name": "FormAuth",
								"identityManagerLogin": identityManager,
								"identityManagerSignup": identityManager,
								"identityManagerEdit": identityManager
							}
						]
					}, {
						"name": "Edit"
					}, {
						"name": "MetadataManager",
						"controls": [{
							"tag": "sticky",
							"labelMark": "Pin",
							"labelUnmark": "Unpin",
							"visible": {
								"user.roles": ["moderator"],
								"user.state": ["ModeratorApproved"]
							}
						}]
					}]
				});
			</script>
			<!-- // -->
		</div>

		<div class="wrapper">
			<!-- Echo.Auth v2 -->
			<b>FormAuth</b>
			<div id="auth-form-v2"></div>
			<script type="text/javascript">
				new Echo.Auth({
					"target": document.getElementById("auth-form-v2"),
					"appkey": "echo.jssdk.demo.aboutecho.com",
					"identityManager": {
						"login": identityManager,
						"signup": identityManager
					}
				});
			</script>
			<!-- // -->
		</div>

		<div class="wrapper">
			<!-- Echo.Submit v2 -->
			<b>Submit</b>
			<div id="submit-form-v2"></div>
			<script type="text/javascript">
				new Echo.Submit({
					"target": document.getElementById("submit-form-v2"),
					"appkey": "echo.jssdk.demo.aboutecho.com",
					"targetURL": "http://example.com/js-sdk",
					"plugins": [{
						"name": "FormAuth",
						"identityManagerLogin": identityManager,
						"identityManagerSignup": identityManager,
						"identityManagerEdit": identityManager,
						"submitPermissions": "forceLogin"
					} , {
						"name": "SubmitTextCounter",
						"limit": 40,
						"label": "You have typed {typed} chars, {left} chars left"
					}]
				});
			</script>
			<!-- // -->
		</div>

		<div class="wrapper">
			<!-- Echo.Counter v2 -->
			<b>Counter</b>
			<div id="counter-v2"></div>
			<script type="text/javascript">
				new Echo.Counter({
					"target": document.getElementById("counter-v2"),
					"appkey": "echo.jssdk.demo.aboutecho.com",
					"query": "childrenof:http://example.com/*"
				});
			</script>
			<!-- // -->
		</div>

		<div class="wrapper">
			<!-- Echo.UserList v2 -->
			<b>User List</b>
			<div id="user-list-v2"></div>
			<script type="text/javascript">
				new Echo.UserList({
					"target": document.getElementById("user-list-v2"),
					"appkey": "echo.jssdk.demo.aboutecho.com",
					"query": "childrenof:http://example.com/*",
					"suffixText": " commented on aboutecho.com",
					"item": {"avatar": true, "text": true}
				});
			</script>
			<!-- // -->
		</div>
	</div>

	<div id="container-v3">
		<h2>JS SDK v3 Applications</h2>
		<div class="wrapper">
			<!-- Echo.StreamServer.BundledApps.Stream.ClientWidget v3 -->
			<b>Stream</b>
			<div id="stream-v3"></div>
			<script>
				Echo.require(["loadFrom![echo/streamserver.sdk]echo/streamserver/bundled-apps/stream/client-widget"], function(App) {
					new App({
						"backplane": {
							"serverBaseURL": "https://api.echoenabled.com/v1",
							"busName": "jskit"
						},
						"target": document.getElementById("stream-v3"),
						"query": "childrenof:http://example.com/* itemsPerPage:1",
						"appkey": "echo.jssdk.demo.aboutecho.com",
						"item": {
							"viaLabel": { "icon": true, "text": true }
						},
						"plugins": [{
							"component": "echo/streamserver/bundled-apps/stream/item/plugins/tweet-display"
						}, {
							"component": "echo/streamserver/bundled-apps/stream/item/plugins/reply",
							"nestedPlugins": [{
								"component": "echo/streamserver/bundled-apps/submit/plugins/form-auth",
								"identityManager": {
									"login": identityManager,
									"signup": identityManager
								}
							}]
						}, {
							"component": "echo/streamserver/bundled-apps/stream/item/plugins/metadata-manager",
							"controls": [{
								"marker": "sticky",
								"labelMark": "Pin",
								"labelUnmark": "Unpin"
							}, {
								"tag": "football",
								"labelMark": "Set Football tag",
								"labelUnmark": "Unset Football tag"
							}]
						}, {
							"component": "echo/streamserver/bundled-apps/stream/item/plugins/like"
						}, {
							"component": "echo/streamserver/bundled-apps/stream/item/plugins/edit"
						}, {
							"component": "echo/streamserver/bundled-apps/stream/item/plugins/community-flag",
							"showUserList": true
						}, {
							"component": "echo/streamserver/bundled-apps/stream/item/plugins/moderation"
						}]
					});
				});
			</script>
			<!-- // -->
		</div>

		<div class="wrapper">
			<!-- Echo.Auth v3 -->
			<b>FormAuth</b>
			<div id="auth-form-v3"></div>
			<script type="text/javascript">
				Echo.require(["loadFrom![echo/streamserver.sdk]echo/streamserver/bundled-apps/auth/client-widget"], function(App) {
					new App({
						"backplane": { 
							"serverBaseURL": "https:{%=baseURLs.api.backplane%}/v1",
							"busName": "jskit"
						},
						"target": document.getElementById("auth-form-v3"),
						"appkey": "echo.jssdk.demo.aboutecho.com",
						"targetURL": "http://echosandbox.com/use-cases/commenting",
						"identityManager": {
							"login": identityManager,
							"signup": identityManager
						}
					});
				});
			</script>
			<!-- // -->
		</div>

		<div class="wrapper">
			<!-- Echo.StreamServer.BundledApps.Submit.ClientWidget v3 -->
			<b>Submit</b>
			<div id="submit-form-v3"></div>
			<script type="text/javascript">
				Echo.require(["loadFrom![echo/streamserver.sdk]echo/streamserver/bundled-apps/submit/client-widget"], function(App) {
					new App({
						"backplane": {
							"serverBaseURL": "https://api.echoenabled.com/v1",
							"busName": "jskit"
						},
						"target": document.getElementById("submit-form-v3"),
						"appkey": "echo.jssdk.demo.aboutecho.com",
						"targetURL": "http://example.com/test-js-sdk",
						"plugins": [{
							"component": "echo/streamserver/bundled-apps/submit/plugins/form-auth",
							"submitPermissions": "forceLogin",
							"identityManager": {
								"login": identityManager,
								"signup": identityManager
							}
						}, {
							"component": "echo/streamserver/bundled-apps/submit/plugins/text-counter",
							"limit": 40,
							"label": "You have typed {typed} chars, {left} chars left"
						}]
					});
				});
			</script>
			<!-- // -->
		</div>

		<div class="wrapper">
			<!-- Echo.StreamServer.BundledApps.Counter.ClientWidget v3 -->
			<b>Counter</b>
			<div id="counter-v3"></div>
			<script type="text/javascript">
				Echo.require(["loadFrom![echo/streamserver.sdk]echo/streamserver/bundled-apps/counter/client-widget"], function(App) {
					new App({
						"target": document.getElementById("counter-v3"),
						"appkey": "echo.jssdk.demo.aboutecho.com",
						"query" : "childrenof:http://example.com/*"
					});
				});
			</script>
			<!-- // -->
		</div>

		<div class="wrapper">
			<!-- Echo.StreamServer.BundledApps.FacePile.ClientWidget v3 -->
			<b>Face Pile</b>
			<div id="face-pile-v3"></div>
			<script type="text/javascript">
				Echo.require(["loadFrom![echo/streamserver.sdk]echo/streamserver/bundled-apps/facepile/client-widget"], function(App) {
					new App({
						"backplane": {
							"serverBaseURL": "https://api.echoenabled.com/v1",
							"busName": "jskit"
						},
						"target": document.getElementById("face-pile-v3"),
						"appkey": "echo.jssdk.demo.aboutecho.com",
						"query": "childrenof:http://example.com/*",
						"suffixText": " commented on aboutecho.com",
						"item": {"avatar": true, "text": true}
					});
				});
			</script>
			<!-- // -->
		</div>
	</div>
	<div class="clear"></div>
</div>
</body>
</html>
