<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">(function(jQuery) {
&quot;use strict&quot;;

var $ = jQuery;

if (!window.Echo) window.Echo = {};

if (!Echo.GUI) Echo.GUI = {};

if (Echo.GUI.Dropdown) return;

<span id='Echo-GUI-Dropdown-method-constructor'><span id='Echo-GUI-Dropdown-cfg-entries'><span id='Echo-GUI-Dropdown-cfg-icon'><span id='Echo-GUI-Dropdown-cfg-title'><span id='Echo-GUI-Dropdown-cfg-extraClass'><span id='Echo-GUI-Dropdown-cfg-target'><span id='Echo-GUI-Dropdown'>/**
</span></span></span></span></span></span></span> * @class Echo.GUI.Dropdown
 * Class wrapper for &lt;a href=&quot;http://twitter.github.com/bootstrap/javascript.html#dropdowns&quot; target=&quot;_blank&quot;&gt;bootstrap-dropdown.js&lt;/a&gt;.
 * The Echo.GUI.Dropdown class provides a simplified interface to work with the
 * Bootstrap Dropdown JS class.
 * Echo wrapper assembles the HTML code required for Bootstrap Dropdown JS class
 * based on the parameters specified in the config and initializes
 * the corresponding Bootstrap JS class.
 *
 * Example:
 *
 * 	var dropdown = new Echo.GUI.Dropdown({
 * 		&quot;target&quot;: &quot;.css-selector&quot;,
 * 		&quot;title&quot;: &quot;Dropdown title&quot;,
 * 		&quot;extraClass&quot;: &quot;nav&quot;,
 * 		&quot;entries&quot;: [{
 * 			&quot;title&quot;: &quot;entry1&quot;,
 * 			&quot;handler&quot;: function() {},
 * 			&quot;icon&quot;: &quot;http://example.com/icon.png&quot;
 * 		}, {
 * 			&quot;title&quot;: &quot;entry2&quot;
 * 		}]
 * 	});
 *
 * 	// Change the dropdown title
 * 	dropdown.setTitle(&quot;New dropdown title&quot;);
 *
 * 	// Update the dropdown entities
 * 	dropdown.updateEntries([{
 * 		&quot;title&quot;: &quot;New entry&quot;,
 * 		&quot;handler&quot;: function() {}
 * 	}, {
 * 		&quot;title&quot;: &quot;New entry 2&quot;
 * 	}]);
 *
 * @extends Echo.GUI
 *
 * @package gui.pack.js
 *
 * @constructor
 * Creates a new dropdown in the container you have passed in the &quot;config.target&quot;.
 *
 * @param {Object} config
 * Dropdown parameters.
 *
 * @cfg {Mixed} target(required)
 * The container where the dropdown should be located.
 * This parameter can have several types:
 *
 * + CSS selector (ex: &quot;.css-selector&quot;)
 * + HTMLElement (ex: document.getElementById(&quot;some-element-id&quot;))
 * + jQuery object (ex: $(&quot;.css-selector&quot;))
 *
 * @cfg {String} [extraClass=&quot;&quot;]
 * Custom class name which should be added to the dropdown.
 *
 * @cfg {String} [title=&quot;&quot;]
 * Dropdown title.
 *
 * @cfg {String} [icon=&quot;&quot;]
 * URL of the 14x14px icon to be displayed near the dropdown title.
 *
 * @cfg {Array} [entries=[]]
 * Array of the dropdown entries.
 * Each entry is the object with the following parameters:
 *
 * + title - entry title
 * + handler - function which will be called when entry is selected
 * + icon - URL for the icon. Icon size should be 16x16 pixels.
 * + entries - Array of nested entries.
 */
Echo.GUI.Dropdown = Echo.Utils.inherit(Echo.GUI, function(config) {
	Echo.GUI.call(this, config, {
		&quot;title&quot;: &quot;&quot;,
		&quot;extraClass&quot;: &quot;&quot;,
		&quot;entries&quot;: []
	});
});

Echo.GUI.Dropdown.prototype.refresh = function() {
	this.config.get(&quot;target&quot;).empty();
	this._container = this._assembleContainer();
	this._assembleEntries(this._container, this.config.get(&quot;entries&quot;));
};

<span id='Echo-GUI-Dropdown-method-setTitle'>/**
</span> * This method allows to change dropdown title.
 *
 * @param {String} title
 * Dropdown title.
 */
Echo.GUI.Dropdown.prototype.setTitle = function(title) {
	$(&quot;.dropdown-toggle&quot;, this.config.get(&quot;target&quot;)).empty().append(title);
};

<span id='Echo-GUI-Dropdown-method-updateEntries'>/**
</span> * This method allows to re-assemble dropdown entries.
 *
 * @param {Array} entries
 * Array of the dropdown entries. The structure of this array is the same as in
 * {@link #cfg-entries entries} config parameter.
 */
Echo.GUI.Dropdown.prototype.updateEntries = function(entries) {
	this.config.set(&quot;entries&quot;, entries);
	$(&quot;.dropdown-menu&quot;, this.config.get(&quot;target&quot;)).remove();
	this._assembleEntries(this._container, entries);
};

Echo.GUI.Dropdown.prototype._assembleContainer = function() {
	 var template =
		&#39;&lt;li class=&quot;dropdown&quot;&gt;&#39; +
			&#39;&lt;a class=&quot;dropdown-toggle&quot; data-toggle=&quot;dropdown&quot; role=&quot;button&quot; href=&quot;#&quot;&gt;&#39; +
				this.config.get(&quot;title&quot;) +
			&#39;&lt;/a&gt;&#39; +
		&#39;&lt;/li&gt;&#39;;
	var dropdown = $(template);
	$(&quot;.dropdown-toggle&quot;, dropdown).dropdown();
	if (this.config.get(&quot;icon&quot;)) {
		$(&quot;.dropdown-toggle&quot;, dropdown)
			.css(&quot;background&quot;, &quot;no-repeat url(&quot; + this.config.get(&quot;icon&quot;) + &quot;) 3px 0px&quot;)
			.css(&quot;padding-left&quot;, &quot;23px&quot;);
	}
	this.config.get(&quot;target&quot;).append($(&#39;&lt;ul class=&quot;&#39; + this.config.get(&quot;extraClass&quot;) + &#39;&quot;&gt;&#39;).append(dropdown));

	return dropdown;
};

Echo.GUI.Dropdown.prototype._assembleEntries = function(container, entries) {
	var self = this;
	var menu = $(&#39;&lt;ul class=&quot;dropdown-menu&quot; role=&quot;menu&quot;&gt;&#39;);
	container.append(menu);

	$.map(entries, function(entry) {
		var item = $(&quot;&lt;a role=&#39;button&#39; class=&#39;echo-clickable&#39; /&gt;&quot;)
			.click(function() {
				entry.handler &amp;&amp; entry.handler.call(this, entry);
			});
		if (entry.icon) {
			item.addClass(&quot;icon&quot;);
			item.css({
				&quot;background-image&quot;: &quot;url(&quot; + entry.icon + &quot;)&quot;
			});
		}
		var li = $(&quot;&lt;li&gt;&quot;).appendTo(menu);
		item.append(entry.title).appendTo(li);
		if (entry.entries) {
			li.addClass(&quot;dropdown-submenu&quot;);
			self._assembleEntries(li, entry.entries);
		}
	});
	return menu;
};

})(Echo.jQuery);
</pre>
</body>
</html>
